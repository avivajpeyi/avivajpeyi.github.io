<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu8bb3cd4a71e1097e37400a0f18d2a5e2_266862_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu8bb3cd4a71e1097e37400a0f18d2a5e2_266862_192x192_fill_lanczos_center_3.png><link rel=canonical href=https://avivajpeyi.github.io/slides/journal_club/sbi_for_sgwb/><title>SBI for SGBW | Avi Vajpeyi</title><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reveal.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/theme/white.min.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css></head><body><div class=reveal><div class=slides><section><h2 id=sbi-for-sgwb>SBI for SGWB</h2><p><em>Simulation based infernce for Stochastic GW background Analysis</em>
(Alvey et al, 2023)</p><p><a href=https://arxiv.org/pdf/2309.07954.pdf target=_blank rel=noopener>arxiv</a> | <a href=https://github.com/undark-lab/swyft target=_blank rel=noopener>swyft</a></p><p>NZ Gravity Journal Club</p><p>Oct 26th, 2023</p></section><section><h2 id=summary>Summary</h2><ol><li>Sim based inference</li><li>Alvey et al&rsquo;s LISA SGWB model</li><li>Results + future work</li><li>Some other SBI applications in GW (if time)</li></ol></section><section><section data-shortcode-section><h2 id=sbi-intro>SBI Intro</h2></section><section><h3 id=traditional-problem>Traditional problem</h3><p>$$
p(\theta|d) = \frac{\mathcal{L}(d|\theta)\pi(\theta)}{\color{red}{Z(d)}}= \frac{\mathcal{L}(d|\theta)\pi(\theta)}{\color{red}{\int_{\theta}\mathcal{L}(d|\theta)\pi(\theta) d\theta}}
$$</p><ul><li><em>Monte Carlo</em>: e.g. Rejection sampling</li><li><em>Markov-chain MC</em>: e.g. Metropolis-Hastings, NUTS</li><li><em>Variational Inference</em>: surrogate $p(\theta|d)$</li></ul><p><mark>What if we dont have $\mathcal{L}(d|\theta)$ ?</mark></p></section><section><h3 id=simulation-based-inference>Simulation based inference:</h3><p>New term for:</p><ul><li>Approximate Bayes Computation,</li><li>Likelihood free inference,</li><li>Indirect inference,</li><li>Synthetic likelihood</li></ul></section><section><h3 id=algorithm>Algorithm</h3><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://miro.medium.com/v2/1*oer83KfCCI1AnoqsRtYlRg.png alt loading=lazy data-zoomable width=400 height=400></div></div></figure><p>Compare the &lsquo;simulated&rsquo; data to the &rsquo;true&rsquo; data</p><aside class=notes><ul><li>Marginal inference &ndash; SBI its possible to directly target specific parameters for inference, ignore other parameters while still dealing correctly with the ones we dont care about</li><li>Amortized &ndash; SBI once trained &ndash; we can get answers of the posteriors very quickly</li></ul></aside></section><section><h3 id=different-sbi-methods>Different SBI methods:</h3><ul><li><strong>Classical</strong>: Rejection ABC (&lsquo;97), MCMC-ABC (&lsquo;03)</li><li><strong>Neural density</strong>:<ul><li>Neural posterior estimator</li><li>Neural likelihood estimator</li><li>Neural <em>ratio</em> estimator (Lnl/evid)</li></ul></li><li><strong>Types of NN:</strong><ul><li>Mixture density networks</li><li>Normalising flows</li></ul></li></ul></section><section><h3 id=goals-for-nn--sbi>Goals for NN + SBI:</h3><ul><li><em>Speed</em>: Training faster than MCMC</li><li><em>Scalability</em>: Doesn&rsquo;t fall apart with high D</li><li><em>Pre-existing research</em>: Leverage modern ML tools (flows, NNs &mldr;)</li></ul></section><section><h3 id=mcmc-vi-sbi>MCMC, VI, SBI</h3><table><thead><tr><th></th><th>MCMC</th><th>VI</th><th>SBI</th></tr></thead><tbody><tr><td>Explicit Likelihood</td><td>✅</td><td>✅</td><td>❌</td></tr><tr><td>Requires gradients</td><td>✅</td><td>(✅)</td><td>❌</td></tr><tr><td>Targeted inference</td><td>✅</td><td>✅</td><td>❌</td></tr><tr><td>Amortized</td><td>❌</td><td>(✅)</td><td>✅</td></tr><tr><td>Specialised architechture</td><td>❌</td><td>✅</td><td>✅</td></tr><tr><td>Requires data summaries</td><td>❌</td><td>❌</td><td>✅</td></tr><tr><td>Marginal inference</td><td>❌</td><td>❌</td><td>✅</td></tr></tbody></table><aside class=notes>Amortized posterior is one that is not focused on any particular observation</aside></section><section><h3 id=end-of-section>END OF SECTION</h3></section></section><section><section data-shortcode-section><h2 id=sbi-math>SBI Math</h2><p><strong>Skipping this, can come back if folks interested</strong></p><aside class=notes><p>Library: swyft
Simulation efficient marginal posterior estimation</p><p>Target: X</p><ul><li>say there are lots of parameters $\theta$</li><li>Only parameter values that plausiablly generate X will contribut to marginaliation</li><li>NESTED RATIO ESTIMATION finds this region by iteratively cnstraining the initial prior based on 1D marginal posteriors from previous iterations</li><li>this method approximates the likelihood-to-evidence ratio by zeroing in on the high-likelihood regions</li><li>method inspired by nested sampling</li><li>After a few iteraintins &ndash; some 1D marginals will be mre constrained than others</li></ul><p><a href="https://pbs.twimg.com/media/E65qN0dWEAAxXCW?format=png&amp;name=900x900" target=_blank rel=noopener>https://pbs.twimg.com/media/E65qN0dWEAAxXCW?format=png&name=900x900</a></p></aside></section><section><h3 id=d_kl-loss-function-for-training>$D_{KL}$ &ldquo;Loss&rdquo; function for training</h3><p>$$D_{\rm KL}(\tilde{p}, p) = \int \tilde{p}(x) \log \frac{\tilde{p}(x)}{p(x)}\ dx$$</p><p>$D_{KL}$ is <em>not</em> symmetric</p><ul><li>$D_{\rm KL}(\tilde{p}, p)$: Variational inference (LnL based)</li><li>$D_{\rm KL}(p, \tilde{p})$: NPE (Simulation based)</li></ul><p><strong>PROBLEM:</strong> how do we avoid evaluating the $p(\theta|d)$?</p></section><section><h3 id=kl-divergence-and-vi>KL-Divergence and VI</h3><p>$$D_{\rm KL} [\tilde{p}, p] (\theta) \sim \mathbb{E}_{\theta\sim\tilde{p}(\theta|d)} \log \left[ \frac{\tilde{p}(\theta|d)}{\mathcal{L}(d|\theta)\pi(\theta)} \right] + C$$</p><ul><li><strong>PROBLEM:</strong> $p(\theta|d)$ is $$$</li><li><strong>SOLUTION:</strong><ul><li>$p(\theta|d) \sim \mathcal{L}(d|\theta)\pi(\theta)$</li><li>$0\leq D_{\rm KL} [\tilde{p}, p]\leq Z(d)$</li><li>Train $\tilde{p}(\theta|d)$</li></ul></li></ul></section><section><h3 id=kl-divergence-and-sbi>KL-Divergence and SBI</h3><p>$$D_{\rm KL}[p, \tilde{p}] (\theta, d) \sim -\mathbb{E}_{(\theta,d)\sim p(\theta,d)} \log \tilde{p}(\theta| d) + C $$</p><ul><li><strong>PROBLEM:</strong> $p(\theta|d)$ is $$$</li><li><strong>SOLUTION:</strong><ul><li>sample from $p_{\rm joint}(\theta, d) = \mathcal{L}(d|\theta)\pi(\theta)$</li><li>Train $\tilde{p}(\theta|d)$</li></ul></li></ul></section><section><h3 id=marginal-sbi-vs-vi>Marginal SBI vs VI</h3><p><strong>Variatinal inference</strong></p><ul><li>variational posterior $\tilde{p}(\vec{\theta}|d)$ must conver <em>all</em> params likelihoodd model condditioned on</li></ul><p><strong>SBI Marginal inference</strong></p><ul><li>Can replace $\tilde{p}(\vec{\theta}|d)$ for $\tilde{p}(\theta_1|d)$ without need of doing integrals</li></ul></section><section><h3 id=end-of-section-1>END OF SECTION</h3></section></section><section data-noprocess data-shortcode-slide data-background-image=https://user-images.githubusercontent.com/15642823/277592172-be608f89-4e27-489f-b3ab-48011968790d.jpeg><h2 id=marginal-inference>&ldquo;Marginal&rdquo; inference</h2><p>$${\color{red}p(\theta_{\rm Waldo}| \rm{image})} =$$
$$\int {\color{blue}p(\theta_{A}, \theta_{B} &mldr; \theta_{\rm Waldo}| \rm{image})}\ d\theta_A\ d\theta_B\ d\theta_{\rm Waldo} $$</p><ul><li>VI: have to learn <em>whole</em> $\color{blue}p(\vec{\theta}|d)$</li><li>SBI: can focus on specific params $\color{red}p(\theta_{\rm Waldo}|d)$</li></ul></section><section><h2 id=code-highlighting>Code Highlighting</h2><p>Inline code: <code>variable</code></p><p>Code block:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>porridge</span> <span class=o>=</span> <span class=s2>&#34;blueberry&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>porridge</span> <span class=o>==</span> <span class=s2>&#34;blueberry&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Eating...&#34;</span><span class=p>)</span>
</span></span></code></pre></div></section><section><h2 id=math>Math</h2><p>In-line math: $x + y = z$</p><p>Block math:</p><p>$$
f\left( x \right) = ;\frac{{2\left( {x + 4} \right)\left( {x - 4} \right)}}{{\left( {x + 4} \right)\left( {x + 1} \right)}}
$$</p></section><section><h2 id=fragments>Fragments</h2><p>Make content appear incrementally</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{{&lt; fragment &gt;}} $\mathbf{y} =  $ {{&lt; /fragment &gt;}}
</span></span><span class=line><span class=cl>{{&lt; fragment &gt;}} $X\boldsymbol\beta$ {{&lt; /fragment &gt;}}
</span></span><span class=line><span class=cl>{{&lt; fragment &gt;}} $+ \boldsymbol\varepsilon$ {{&lt; /fragment &gt;}}
</span></span></code></pre></div><p>Press <code>Space</code> to play!</p><p><span class=fragment>$\mathbf{y} = $</span>
<span class=fragment>$X\boldsymbol\beta$</span>
<span class=fragment>$+ \boldsymbol\varepsilon$</span></p></section><section><p>A fragment can accept two optional parameters:</p><ul><li><code>class</code>: use a custom style (requires definition in custom CSS)</li><li><code>weight</code>: sets the order in which a fragment appears</li></ul></section><section><h2 id=speaker-notes>Speaker Notes</h2><p>Add speaker notes to your presentation</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>{{% speaker_note %}}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>-</span> Only the speaker can read these notes
</span></span><span class=line><span class=cl><span class=k>-</span> Press <span class=sb>`S`</span> key to view
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{{% /speaker_note %}}
</span></span></code></pre></div><p>Press the <code>S</code> key to view the speaker notes!</p><aside class=notes><ul><li>Only the speaker can read these notes</li><li>Press <code>S</code> key to view</li></ul></aside></section><section><h2 id=themes>Themes</h2><ul><li>black: Black background, white text, blue links (default)</li><li>white: White background, black text, blue links</li><li>league: Gray background, white text, blue links</li><li>beige: Beige background, dark text, brown links</li><li>sky: Blue background, thin dark text, blue links</li></ul></section><section><ul><li>night: Black background, thick white text, orange links</li><li>serif: Cappuccino background, gray text, brown links</li><li>simple: White background, black text, blue links</li><li>solarized: Cream-colored background, dark green text, blue links</li></ul></section><section data-noprocess data-shortcode-slide data-background-image=boards.webp><h2 id=custom-slide>Custom Slide</h2><p>Customize the slide style and background</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>{{<span class=p>&lt;</span> <span class=nt>slide</span> <span class=na>background-image</span><span class=o>=</span><span class=s>&#34;boards.webp&#34;</span> <span class=p>&gt;</span>}}
</span></span><span class=line><span class=cl>{{<span class=p>&lt;</span> <span class=nt>slide</span> <span class=na>background-color</span><span class=o>=</span><span class=s>&#34;#0000FF&#34;</span> <span class=p>&gt;</span>}}
</span></span><span class=line><span class=cl>{{<span class=p>&lt;</span> <span class=nt>slide</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;my-style&#34;</span> <span class=p>&gt;</span>}}
</span></span></code></pre></div></section><section><h2 id=custom-css-example>Custom CSS Example</h2><p>Let&rsquo;s make headers navy colored.</p><p>Create <code>assets/css/reveal_custom.css</code> with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=p>.</span><span class=nc>reveal</span> <span class=nt>section</span> <span class=nt>h1</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>reveal</span> <span class=nt>section</span> <span class=nt>h2</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>reveal</span> <span class=nt>section</span> <span class=nt>h3</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>color</span><span class=p>:</span> <span class=kc>navy</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></section><section><h2 id=questions>Questions?</h2><p><a href=https://discord.gg/z8wNYzb target=_blank rel=noopener>Ask</a></p><p><a href=https://wowchemy.com/docs/content/slides/ target=_blank rel=noopener>Documentation</a></p></section><section></section></div></div><script src=https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reveal.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/markdown/markdown.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/notes/notes.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/search/search.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/math/math.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/zoom/zoom.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js-menu@2.1.0/plugin.js integrity="sha256-M6JwAjnRAWmi+sbXURR/yAhWZKYhAw7YXnnLvIxrdGs=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js-menu@2.1.0/menu.js integrity="sha256-l14dklFcW5mWar6w/9KaW0fWVerf3mYr7Wt0+rXzFAA=" crossorigin=anonymous></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/reveal.js-menu@2.1.0/menu.css integrity="sha256-0fU8HKLaTjgzfaV9CgSqbsN8ilA3zo6zK1M6rlgULd8=" crossorigin=anonymous><script src=/js/wowchemy-slides.js></script></body></html>